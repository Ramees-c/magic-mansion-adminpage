<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="Magic Mansion Real Estate - Admin" />
    <meta name="author" content="Magic Mansion Real Estate" />
    <title>Magic Mansion Real Estate - Admin</title>
    <link
      rel="icon"
      href="./assets/images/icons/brand-icon.png"
      type="image/x-icon"
    />
    <!-- Favicon-->
    <link
      rel="stylesheet"
      href="./assets/plugins/bootstrap/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="./assets/plugins/dropzone/dropzone.css" />

    <!-- Bootstrap Select Css -->
    <link
      rel="stylesheet"
      href="../assets/plugins/bootstrap-select/css/bootstrap-select.css"
    />

    <!-- Custom Css -->
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/color_skins.css" />

    <style>
      .property-file-upload {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .property-upload-btn {
        display: inline-block;
        padding: 8px 8px;
        background-color: #333;
        color: #fff;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        text-align: center;
      }

      .property-file-upload input[type="file"] {
        display: none;
      }

      .property-preview-gallery {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .property-preview-box {
        position: relative;
      }

      .property-image-preview {
        max-width: 160px;
        max-height: 160px;
        border-radius: 4px;
        border: 1px solid #ddd;
      }

      .property-remove-btn {
        position: absolute;
        top: -8px;
        right: -8px;
        padding: 3px 8px;
        background-color: #ff4444;
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        font-size: 12px;
        line-height: 1;
      }

      .property-remove-btn:hover {
        background-color: #cc0000;
      }
      .property-pdf-preview {
        max-width: 200px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background-color: #f8f9fa;
        position: relative;
        font-size: 14px;
        font-weight: 500;
        word-wrap: break-word;
      }

      .property-preview-gallery canvas {
        max-width: 160px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }

      .property-preview-box {
        position: relative;
      }
    </style>
  </head>

  <body style="background-color: #ede8d0">
    <!-- Page Loader -->
    <div class="page-loader-wrapper">
      <div class="loader">
        <div class="m-t-30">
          <img
            class="zmdi-hc-spin"
            src="./assets/images/icons/brand-icon.png"
            width="48"
            height="48"
            alt="Oreo"
          />
        </div>
        <p>Please wait...</p>
      </div>
    </div>
    <!-- Overlay For Sidebars -->
    <div class="overlay"></div>

    <!-- Top Bar -->
    <nav class="navbar p-l-5 p-r-5">
      <ul class="nav navbar-nav navbar-left">
        <li>
          <div class="navbar-header">
            <a href="javascript:void(0);" class="bars"></a>
          </div>
        </li>

        <li class="float-right">
          <a href="sign-in.html" class="mega-menu" data-close="true"
            ><i class="zmdi zmdi-power"></i
          ></a>
        </li>
      </ul>
    </nav>

    <!-- Left Sidebar -->
    <aside id="leftsidebar" class="sidebar">
      <div class="tab-content">
        <div class="tab-pane stretchRight active" id="dashboard">
          <div class="menu">
            <ul class="list">
              <li>
                <a class="navbar-brand" href="index.html"
                  ><img
                    src="./assets/images/logo/logo-full-white.png"
                    width="150"
                    alt="logo"
                /></a>
              </li>

              <li>
                <a href="index.html"
                  ><i class="zmdi zmdi-home"></i><span>Dashboard</span></a
                >
              </li>

              <li>
                <a href="users.html"
                  ><i class="zmdi zmdi-accounts"></i><span>Users</span></a
                >
              </li>

              <li>
                <a href="javascript:void(0);" class="menu-toggle"
                  ><i class="zmdi zmdi-comment-text"></i
                  ><span>Attributes</span></a
                >
                <ul class="ml-menu">
                  <li><a href="property-types.html">Property Type </a></li>
                  <li><a href="community.html">Community / Area</a></li>
                  <li><a href="amenities.html">Amenities</a></li>
                  <li><a href="Builders.html">Builders </a></li>
                </ul>
              </li>
              <li class="active open">
                <a href="javascript:void(0);" class="menu-toggle"
                  ><i class="zmdi zmdi-city"></i><span>Property</span></a
                >
                <ul class="ml-menu">
                  <li><a href="property-list.html">Property List</a></li>
                  <li class="active">
                    <a href="property-add.html">Add Property</a>
                  </li>
                  <li><a href="property-draft.html">Property Drafts</a></li>
                </ul>
              </li>

              <li>
                <a href="javascript:void(0);" class="menu-toggle"
                  ><i class="zmdi zmdi-blogger"></i><span>Blog</span></a
                >
                <ul class="ml-menu">
                  <li><a href="blog-post.html">New Post</a></li>
                  <li><a href="blog-list.html">Blog List</a></li>
                  <li><a href="blog-drafts.html">Blog Drafts</a></li>
                </ul>
              </li>
              <li>
                <a href="javascript:void(0);" class="menu-toggle"
                  ><i class="zmdi zmdi-collection-image"></i
                  ><span>Image Gallery</span></a
                >
                <ul class="ml-menu">
                  <li><a href="property-images.html">Propery Images</a></li>
                  <li><a href="blog-images.html">Blog Images</a></li>
                  <li>
                    <a href="builders-logogallery.html">Buiilders Logos</a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <section class="content">
      <div class="container-fluid">
        <div class="row clearfix">
          <div class="col-lg-12">
            <div class="card">
              <div class="header">
                <h2><strong>Add</strong> Property</h2>
              </div>
              <div class="body">
                <form action="#" method="post" enctype="multipart/form-data">
                  <div class="row clearfix">
                    <div class="col-sm-12">
                      <div class="form-group">
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Property Name"
                          name="property_name"
                        />
                      </div>
                    </div>

                    <div class="col-sm-12">
                      <div class="form-group">
                        <textarea
                          rows="4"
                          class="form-control no-resize"
                          placeholder="Property Address"
                          name="property_address"
                        ></textarea>
                      </div>
                    </div>

                    <div class="col-sm-12">
                      <div class="form-group">
                        <div class="form-line">
                          <textarea
                            rows="4"
                            class="form-control no-resize"
                            placeholder="Property Description"
                            name="property_description"
                          ></textarea>
                        </div>
                      </div>
                    </div>
                  </div>
                  <h6 class="mt-4">Property Information</h6>
                  <div class="row clearfix">
                    <div class="col-sm-6">
                      <div class="radio inlineblock m-r-25">
                        <input
                          type="radio"
                          name="property_type"
                          id="radio1"
                          value="For Rent"
                          checked=""
                        />
                        <label for="radio1">For Rent</label>
                      </div>
                      <div class="radio inlineblock m-r-25">
                        <input
                          type="radio"
                          name="property_type"
                          id="radio2"
                          value="For Sale"
                        />
                        <label for="radio2">For Sale</label>
                      </div>
                      <div class="radio inlineblock m-r-25">
                        <input
                          type="radio"
                          name="property_type"
                          id="radio3"
                          value="For Buy"
                        />
                        <label for="radio3">For Buy</label>
                      </div>
                      <div class="radio inlineblock m-r-25">
                        <input
                          type="radio"
                          name="property_type"
                          id="radio4"
                          value="For Lease"
                        />
                        <label for="radio4">For Lease</label>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-group">
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Price / Rent"
                          name="price"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-6">
                      <div class="form-group">
                        <input
                          type="number"
                          class="form-control"
                          placeholder="Number of Bedrooms"
                          name="bedrooms"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-6">
                      <div class="form-group">
                        <input
                          type="number"
                          class="form-control"
                          placeholder="Number of Bathrooms"
                          name="bathrooms"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-6">
                      <div class="form-group">
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Min Square ft"
                          name="min_sqft"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-6">
                      <div class="form-group">
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Max Square ft"
                          name="max_sqft"
                        />
                      </div>
                    </div>

                    <div class="col-sm-6">
                      <div class="form-group">
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Property Location"
                          name="location"
                        />
                      </div>
                    </div>
                  </div>

                  <div class="row clearfix">
                    <div class="col-sm-6">
                      <h6 class="mt-4">Property Communities / Area</h6>
                      <select class="form-control show-tick" name="community">
                        <option value="">-- Please select --</option>
                        <option value="Downtown">Downtown</option>
                        <option value="Jumeirah">Jumeirah</option>
                        <option value="Barsha">Barsha</option>
                        <option value="Deira">Deira</option>
                      </select>
                    </div>
                    <div class="col-sm-6">
                      <h6 class="mt-4">Property Type</h6>
                      <select class="form-control show-tick" name="category">
                        <option value="">-- Please select --</option>
                        <option value="Villa">Villa</option>
                        <option value="Flat">Flat</option>
                        <option value="Townhouse">Townhouse</option>
                        <option value="Commercial">Commercial</option>
                      </select>
                    </div>
                  </div>

                  <h6 class="mt-4">General Amenities</h6>
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox21"
                          type="checkbox"
                          name="amenities[]"
                          value="Swimming pool"
                        />
                        <label for="checkbox21">Swimming pool</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox22"
                          type="checkbox"
                          name="amenities[]"
                          value="Terrace"
                        />
                        <label for="checkbox22">Terrace</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox23"
                          type="checkbox"
                          name="amenities[]"
                          value="Air conditioning"
                          checked=""
                        />
                        <label for="checkbox23">Air conditioning</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox24"
                          type="checkbox"
                          name="amenities[]"
                          value="Internet"
                          checked=""
                        />
                        <label for="checkbox24">Internet</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox25"
                          type="checkbox"
                          name="amenities[]"
                          value="Balcony"
                        />
                        <label for="checkbox25">Balcony</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox26"
                          type="checkbox"
                          name="amenities[]"
                          value="Cable TV"
                        />
                        <label for="checkbox26">Cable TV</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox27"
                          type="checkbox"
                          name="amenities[]"
                          value="Computer"
                        />
                        <label for="checkbox27">Computer</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox28"
                          type="checkbox"
                          name="amenities[]"
                          value="Dishwasher"
                          checked=""
                        />
                        <label for="checkbox28">Dishwasher</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox29"
                          type="checkbox"
                          name="amenities[]"
                          value="Near Green Zone"
                          checked=""
                        />
                        <label for="checkbox29">Near Green Zone</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox30"
                          type="checkbox"
                          name="amenities[]"
                          value="Near Church"
                        />
                        <label for="checkbox30">Near Church</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox31"
                          type="checkbox"
                          name="amenities[]"
                          value="Near Estate"
                        />
                        <label for="checkbox31">Near Estate</label>
                      </div>
                      <div class="checkbox inlineblock m-r-20">
                        <input
                          id="checkbox32"
                          type="checkbox"
                          name="amenities[]"
                          value="Cofee pot"
                        />
                        <label for="checkbox32">Cofee pot</label>
                      </div>
                    </div>
                  </div>

                  <div class="row clearfix mb-5">
                    <div class="col-sm-6">
                      <h6 class="mt-4">Property Status</h6>
                      <select class="form-control show-tick" name="status">
                        <option value="">-- Select status --</option>
                        <option selected value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                      </select>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-sm-6">
                      <h6 class="mb-4">Customize Home Page Display</h6>
                       <div class="checkbox inlineblock m-r-20">
                        <input
                          id="addToHomepage"
                          type="checkbox"
                          name="addToHomepage"
                          value="Add To Home Page"
                        />
                        <label for="addToHomepage">Add To Home Page</label>
                      </div>
                    </div>

                    
                  </div>

                  <div class="row mb-5">
                    <div class="col-sm-6">
                       <div class="form-group">
                        <input
                          type="number"
                          class="form-control"
                          placeholder="Enter display order (e.g. 1)"
                          name="displayOrder"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-6 mb-4">
                      <div class="property-file-upload">
                        <label for="propertyImages" class="property-upload-btn">
                          Upload Property Images (Max 6)
                        </label>
                        <input
                          id="propertyImages"
                          type="file"
                          accept="image/*"
                          multiple
                        />
                      </div>
                    </div>

                    <div class="col-sm-12">
                      <div
                        class="property-preview-gallery d-flex flex-wrap gap-3"
                        id="propertyPreviewGallery"
                      ></div>
                    </div>
                  </div>

                  <div class="row mt-5">
                    <div class="col-sm-6 mb-3">
                      <div class="property-file-upload">
                        <label for="floorplanPDF" class="property-upload-btn">
                          Upload Floorplan (PDF Only)
                        </label>
                        <input
                          id="floorplanPDF"
                          type="file"
                          accept="application/pdf"
                        />
                      </div>

                      <!-- Preview container -->
                      <div
                        class="property-preview-gallery mt-3"
                        id="floorplanPreview"
                      ></div>
                    </div>
                  </div>

                  <div class="row mt-5">
                    <div class="col-sm-6 mb-3">
                      <div class="property-file-upload">
                        <label for="brochurePDF" class="property-upload-btn">
                          Upload Brochure (PDF Only)
                        </label>
                        <input
                          id="brochurePDF"
                          type="file"
                          accept="application/pdf"
                        />
                      </div>

                      <!-- Brochure Preview -->
                      <div
                        class="property-preview-gallery mt-3"
                        id="brochurePreview"
                      ></div>
                    </div>
                  </div>

                  <div class="rwo">
                    <div class="col-sm-12 mt-3">
                      <button
                        type="submit"
                        class="btn btn-primary btn-round"
                        name="action"
                        value="publish"
                      >
                        Save & Publish
                      </button>
                      <button
                        type="submit"
                        class="btn btn-secondary btn-round"
                        name="action"
                        value="draft"
                      >
                        Save as Draft
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Jquery Core Js -->
    <script src="assets/bundles/libscripts.bundle.js"></script>
    <script src="assets/bundles/vendorscripts.bundle.js"></script>

    <script src="../assets/plugins/dropzone/dropzone.js"></script>
    <!-- Dropzone Plugin Js -->

    <script src="assets/bundles/mainscripts.bundle.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

    <script>
      document
        .getElementById("propertyImages")
        .addEventListener("change", function (e) {
          const files = e.target.files;
          const previewGallery = document.getElementById(
            "propertyPreviewGallery"
          );

          const existingPreviews = previewGallery.querySelectorAll(
            ".property-preview-box"
          ).length;
          if (existingPreviews + files.length > 6) {
            Swal.fire({
              icon: "warning",
              title: "Image Limit Reached",
              text: "You can only upload a maximum of 6 images.",
              confirmButtonColor: "#3085d6",
            });
            return;
          }

          for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const reader = new FileReader();

            reader.onload = function (event) {
              const previewBox = document.createElement("div");
              previewBox.classList.add("property-preview-box");

              const img = document.createElement("img");
              img.src = event.target.result;
              img.classList.add("property-image-preview");

              const removeBtn = document.createElement("button");
              removeBtn.classList.add("property-remove-btn");
              removeBtn.innerHTML = "&times;";

              removeBtn.addEventListener("click", function () {
                previewBox.remove();
                if (previewGallery.children.length === 0) {
                  document.getElementById("propertyImages").value = "";
                }
              });

              previewBox.appendChild(img);
              previewBox.appendChild(removeBtn);
              previewGallery.appendChild(previewBox);
            };

            reader.readAsDataURL(file);
          }

          e.target.value = "";
        });
    </script>

    <script>
      document
        .getElementById("floorplanPDF")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          const previewContainer = document.getElementById("floorplanPreview");

          if (file) {
            if (file.type !== "application/pdf") {
              alert("Please select a PDF file.");
              e.target.value = "";
              return;
            }

            // Clear existing preview
            previewContainer.innerHTML = "";

            const fileReader = new FileReader();
            fileReader.onload = function () {
              const typedarray = new Uint8Array(this.result);

              pdfjsLib.getDocument(typedarray).promise.then(function (pdf) {
                pdf.getPage(1).then(function (page) {
                  const viewport = page.getViewport({ scale: 1 });
                  const canvas = document.createElement("canvas");
                  const context = canvas.getContext("2d");
                  canvas.height = viewport.height;
                  canvas.width = viewport.width;

                  // Render PDF page into canvas context
                  const renderContext = {
                    canvasContext: context,
                    viewport: viewport,
                  };

                  page.render(renderContext).promise.then(function () {
                    // Wrap in preview box div
                    const box = document.createElement("div");
                    box.classList.add("property-preview-box");

                    // Remove button
                    const removeBtn = document.createElement("button");
                    removeBtn.innerHTML = "&times;";
                    removeBtn.classList.add("property-remove-btn");
                    removeBtn.onclick = function () {
                      box.remove();
                      document.getElementById("floorplanPDF").value = "";
                    };

                    box.appendChild(removeBtn);
                    box.appendChild(canvas);
                    previewContainer.appendChild(box);
                  });
                });
              });
            };

            fileReader.readAsArrayBuffer(file);
          }
        });
    </script>

    <script>
      document
        .getElementById("brochurePDF")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          const previewContainer = document.getElementById("brochurePreview");

          if (file) {
            if (file.type !== "application/pdf") {
              alert("Please select a PDF file.");
              e.target.value = "";
              return;
            }

            // Clear existing brochure preview
            previewContainer.innerHTML = "";

            const fileReader = new FileReader();
            fileReader.onload = function () {
              const typedarray = new Uint8Array(this.result);

              pdfjsLib.getDocument(typedarray).promise.then(function (pdf) {
                pdf.getPage(1).then(function (page) {
                  const viewport = page.getViewport({ scale: 1 });
                  const canvas = document.createElement("canvas");
                  const context = canvas.getContext("2d");
                  canvas.height = viewport.height;
                  canvas.width = viewport.width;

                  const renderContext = {
                    canvasContext: context,
                    viewport: viewport,
                  };

                  page.render(renderContext).promise.then(function () {
                    const box = document.createElement("div");
                    box.classList.add("property-preview-box");

                    const removeBtn = document.createElement("button");
                    removeBtn.innerHTML = "&times;";
                    removeBtn.classList.add("property-remove-btn");
                    removeBtn.onclick = function () {
                      box.remove();
                      document.getElementById("brochurePDF").value = "";
                    };

                    box.appendChild(removeBtn);
                    box.appendChild(canvas);
                    previewContainer.appendChild(box);
                  });
                });
              });
            };

            fileReader.readAsArrayBuffer(file);
          }
        });
    </script>
  </body>
</html>
